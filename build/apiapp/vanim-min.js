KISSY.add("apiapp/vanim",function(a,b,c){var d={TOP:1,RIGHT:2,BOTTOM:4,LEFT:8},e=[{from:/^\/home$/,to:/^\/(?:kissy|seajs|requirejs)\/[21]\.[012]\/index$/,aAnim:"slideLeft",bAnim:"slideRight"},{from:/^\/(?:kissy|seajs|requirejs)\/[12]\.[012]\/index$/,to:/^\/(?:kissy|seajs|requirejs)\/[12]\.[012]\/\w+$/,aAnim:"slideLeft",bAnim:"slideRight"},{from:/^\/home$/,to:/^\/(?:kissy|seajs|requirejs)\/[12]\.[012]\/\w+$/,aAnim:"slideLeft",bAnim:"slideRight"},{from:/^\/(?:kissy|seajs|requirejs)\/[12]\.[012]\/\w+$/,to:/^\/(?:kissy|seajs|requirejs)\/[12]\.[012]\/\w+$/,aAnim:"fade",bAnim:"fade"}],f=c.cache(),g={animCounter:0,getAnimRule:function(a){var b={root:"magix_vf_main"},c=a.changed||a;if(c.isPath()){var d=c.path,g=d.from+"&"+d.to,h=d.to+"&"+d.from;if(f.has(g))b.anim=f.get(g);else for(var i,j=0;j<e.length;j++){if(i=e[j],i.from.test(d.from)&&i.to.test(d.to)){b.anim=i.aAnim,f.set(h,i.bAnim),f.set(g,i.aAnim);break}if(i.to.test(d.from)&&i.from.test(d.to)){b.anim=i.bAnim,f.set(g,i.bAnim),f.set(h,i.aAnim);break}}}return b},processRoot:function(b){var c=a.one("#"+b);if(c&&"BODY"==c.prop("tagName").toUpperCase()){var d=c.children();c.append('<div id="'+b+'"></div>').attr("id",""),c=a.one("#"+b),c.append(d)}},registerAnim:function(a,b){var c=g;c.$anims||(c.$anims={}),c.$anims[a]=b},stopAnims:function(){var a,b=g,c=b.$anims;for(var d in c)a=c[d],a&&a.stop&&a.stop(!0)},fade:function(b){var c=g;c.processRoot(b);var d=a.one("#"+b),e=a.guid("temp");d.after('<div id="'+e+'"></div>');var f=a.one("#"+e);f.append(d.children()),d.css({display:"none",opacity:0}),c.animCounter++,new a.Anim(f,{opacity:0},.5,"easeNone",function(){f.remove(),d.css({display:"block"}),new a.Anim(d,{opacity:1},.5,"easeNone",function(){c.animCounter--}).run()}).run()},slide:function(b,c){var e=g;e.stopAnims(),e.processRoot(b);var f=a.one("#"+b);if(f){var h=f.parent();e.animCounter||(e.$bakPosition=h.css("position"),e.$bakOverflow=h.css("overflow"));var i=h.outerWidth(),j=h.outerHeight();h.css({position:"relative",overflow:"hidden"});var k=a.guid("temp");f.after('<div id="'+k+'"></div>');var l=a.one("#"+k),m={position:"fixed",width:i,height:j,left:0,top:h.offset().top},n={};c==d.LEFT?n={position:"relative",left:i,top:0}:c==d.TOP?n={position:"relative",left:0,top:Math.max(j,a.DOM.docHeight())}:c==d.RIGHT?n={position:"relative",left:-i,top:0}:c==d.BOTTOM&&(n={position:"relative",left:0,top:-Math.max(j,a.DOM.docHeight())}),l.css(m).append(f.children()),f.css(n);var o={},p={};c==d.LEFT?(p.left=-i,o.left=0):c==d.TOP?(o.top=0,p.top=-Math.max(j,a.DOM.docHeight())):c==d.RIGHT?(o.left=0,p.left=i):c==d.BOTTOM&&(o.top=0,p.top=Math.max(j,a.DOM.docHeight())),e.animCounter++,e.registerAnim("slideOld",new a.Anim(f,o,.5,"easeOut").run()),e.registerAnim("slideNew",new a.Anim(l,p,.5,"easeOut",function(){l.remove(),f.css({position:"static",width:"auto",height:"auto"}),e.animCounter--,e.animCounter||h.css({position:e.$bakPosition,overflow:e.$bakOverflow})}).run())}},slideLeft:function(a){g.slide(a,d.LEFT)},slideTop:function(a){g.slide(a,d.TOP)},slideRight:function(a){g.slide(a,d.RIGHT)},slideBottom:function(a){g.slide(a,d.BOTTOM)},locationChange:function(a){if(!a.force){var b=g,c=b.getAnimRule(a);if(c){var d=b[c.anim];d&&d(c.root)}}}};b.on("changed",g.locationChange,0)},{requires:["magix/router","magix/magix","node","anim"]});